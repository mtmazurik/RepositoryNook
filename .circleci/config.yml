version: 2.1
jobs:
  build:
    machine: true
    steps:
        - checkout
        - run: echo ${GOOGLE_AUTH} > ${HOME}/gcp-key.json
        - run: docker build -f ../CCA.Services.RepositoryNook/Dockerfile -t gcr.io/repositorynookproject-263716/reponook-ui:latest .
        - run: gcloud auth activate-service-account --key-file ${HOME}/gcp-key.json
        - run: gcloud --quiet config set project repositorynookproject-263716
        - run: gcloud docker --push cr.io/repositorynookproject-263716/reponook-ui:latest
workflowsw:
  version: 2
  build-master:
    jobs:
        - build